<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">decoder</span>, <span class="var type1" id="S3T2U4">u</span>]= SCL_decoder(<span class="var type1" id="S4T3U7">llr</span>, <span class="var type1" id="S5T4U8">L</span>, <span class="var type1" id="S6T4U9">K</span>, <span class="var type1" id="S7T5U10">frozen_bits</span>, <span class="var type1" id="S8T6U11">lambda_offset</span>, <span class="var type1" id="S9T5U12">llr_layer_vec</span>, <span class="var type1" id="S10T5U13">bit_layer_vec</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="mxinfo " id="T7:U10"><span class="var type1" id="S11T7U16">N</span> = <span class="mxinfo " id="T7:U12">length(<span class="var type1" id="S4T3U19">llr</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="mxinfo " id="T7:U14"><span class="var type1" id="S13T7U22">m</span> = <span class="mxinfo " id="T7:U16">log2(<span class="var type1" id="S11T7U25">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="mxinfo " id="T8:U18"><span class="var type1" id="S15T8U28">P</span> = <span class="mxinfo " id="T8:U20">zeros(<span class="mxinfo " id="T7:U21"><span class="var type1" id="S11T7U32">N</span> - 1</span>, <span class="var type1" id="S5T4U34">L</span>)</span></span>; <span class="comment">%每条路径P是7个</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="mxinfo " id="T8:U24"><span class="var type1" id="S17T8U37">C</span> = <span class="mxinfo " id="T8:U26">zeros(<span class="mxinfo " id="T7:U27"><span class="var type1" id="S11T7U41">N</span> - 1</span>, <span class="mxinfo " id="T4:U29">2 * <span class="var type1" id="S5T4U45">L</span></span>)</span></span>;<span class="comment">%每条路径P是7个</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="mxinfo " id="T2:U31"><span class="var type1" id="S3T2U48">u</span> = <span class="mxinfo " id="T2:U33">zeros(<span class="var type1" id="S6T4U51">K</span>, <span class="var type1" id="S5T4U52">L</span>)</span></span>;<span class="comment">%存放译码，就是非冻结比特 unfrozen bits that polar codes carry, including crc bits.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="mxinfo " id="T9:U36"><span class="var type1" id="S18T9U55">PM</span> = <span class="mxinfo " id="T9:U38">zeros(<span class="var type1" id="S5T4U58">L</span>, 1)</span></span>;<span class="comment">%Path metrics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="mxinfo " id="T9:U40"><span class="var type1" id="S19T9U62">activepath</span> = <span class="mxinfo " id="T9:U42">zeros(<span class="var type1" id="S5T4U65">L</span>, 1)</span></span>;<span class="comment">%Indicate if the path is active. '1'→active; '0' otherwise.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="mxinfo " id="T7:U44"><span class="var type1" id="S20T7U69">cnt_u</span> = <span class="mxinfo " id="T7:U46">1</span></span>;<span class="comment">%information bit counter </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%initialize</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="mxinfo " id="T7:U47"><span class="mxinfo " id="T7:U48"><span class="var type1" id="S19T9U74">activepath</span>(<span class="mxinfo " id="T7:U50">1</span>)</span> = <span class="mxinfo " id="T7:U51">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S21T7U79">phi</span> = <span class="mxinfo " id="T7:U53">0</span> : <span class="var type1" id="S11T7U83">N</span> - 1</span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo " id="T10:U55"><span class="var type1" id="S22T10U87">layer</span> = <span class="mxinfo " id="T10:U57"><span class="var type1" id="S9T5U89">llr_layer_vec</span>(<span class="mxinfo " id="T7:U59"><span class="var type1" id="S21T7U91">phi</span> + <span class="mxinfo " id="T7:U61">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">    <span class="mxinfo " id="T7:U62"><span class="var type1" id="S23T7U95">phi_mod_2</span> = <span class="mxinfo " id="T7:U64">mod(<span class="var type1" id="S21T7U98">phi</span>, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S25T4U102">l_index</span> = <span class="mxinfo " id="T4:U67">1</span> : <span class="var type1" id="S5T4U105">L</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T11:U69"><span class="mxinfo " id="T7:U70"><span class="var type1" id="S19T9U110">activepath</span>(<span class="var type1" id="S25T4U111">l_index</span>)</span> == <span class="mxinfo " id="T7:U73">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">            <span class="keyword">continue</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">        <span class="keyword">switch</span> <span class="var type1" id="S21T7U115">phi</span><span class="comment">%Decoding bits u_0 and u_N/2 needs channel LLR, so the decoding of them is separated from other bits. </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">            <span class="keyword">case</span> <span class="mxinfo " id="T7:U75">0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">                <span class="mxinfo " id="T10:U76"><span class="var type1" id="S26T10U120">index_1</span> = <span class="mxinfo " id="T10:U78"><span class="var type1" id="S8T6U122">lambda_offset</span>(<span class="var type1" id="S13T7U123">m</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S27T10U126">beta</span> = <span class="mxinfo " id="T10:U82">0</span> : <span class="mxinfo " id="T10:U83"><span class="var type1" id="S26T10U130">index_1</span> - <span class="mxinfo " id="T7:U85">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">                    <span class="mxinfo " id="T7:U86"><span class="mxinfo " id="T7:U87"><span class="var type1" id="S15T8U135">P</span>(<span class="mxinfo " id="T10:U89"><span class="var type1" id="S27T10U137">beta</span> + <span class="var type1" id="S26T10U138">index_1</span></span>, <span class="var type1" id="S25T4U139">l_index</span>)</span> = <span class="mxinfo " id="T7:U93"><span class="mxinfo " id="T7:U94"><span class="mxinfo " id="T7:U95">sign(<span class="mxinfo " id="T7:U96"><span class="var type1" id="S4T3U145">llr</span>(<span class="mxinfo " id="T10:U98"><span class="var type1" id="S27T10U147">beta</span> + <span class="mxinfo " id="T7:U100">1</span></span>)</span>)</span> * <span class="mxinfo " id="T7:U101">sign(<span class="mxinfo " id="T7:U102"><span class="var type1" id="S4T3U152">llr</span>(<span class="mxinfo " id="T10:U104"><span class="mxinfo " id="T10:U105"><span class="var type1" id="S27T10U155">beta</span> + <span class="var type1" id="S26T10U156">index_1</span></span> + <span class="mxinfo " id="T7:U108">1</span></span>)</span>)</span></span> * <span class="mxinfo " id="T7:U109">min(<span class="mxinfo " id="T7:U110">abs(<span class="mxinfo " id="T7:U111"><span class="var type1" id="S4T3U163">llr</span>(<span class="mxinfo " id="T10:U113"><span class="var type1" id="S27T10U165">beta</span> + <span class="mxinfo " id="T7:U115">1</span></span>)</span>)</span>, <span class="mxinfo " id="T7:U116">abs(<span class="mxinfo " id="T7:U117"><span class="var type1" id="S4T3U170">llr</span>(<span class="mxinfo " id="T10:U119"><span class="mxinfo " id="T10:U120"><span class="var type1" id="S27T10U173">beta</span> + <span class="var type1" id="S26T10U174">index_1</span></span> + <span class="mxinfo " id="T7:U123">1</span></span>)</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S31T7U178">i_layer</span> = <span class="mxinfo " id="T7:U125"><span class="var type1" id="S13T7U182">m</span> - 2</span> : <span class="mxinfo " id="T7:U127">-1</span> : 0</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">                    <span class="mxinfo " id="T10:U128"><span class="var type1" id="S26T10U189">index_1</span> = <span class="mxinfo " id="T10:U130"><span class="var type1" id="S8T6U191">lambda_offset</span>(<span class="mxinfo " id="T7:U132"><span class="var type1" id="S31T7U193">i_layer</span> + <span class="mxinfo " id="T7:U134">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">                    <span class="mxinfo " id="T10:U135"><span class="var type1" id="S32T10U197">index_2</span> = <span class="mxinfo " id="T10:U137"><span class="var type1" id="S8T6U199">lambda_offset</span>(<span class="mxinfo " id="T7:U139"><span class="var type1" id="S31T7U201">i_layer</span> + <span class="mxinfo " id="T7:U141">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">                    <span class="keyword">for</span> <span class="var type1" id="S27T10U205">beta</span> = <span class="mxinfo " id="T10:U143">0</span> : <span class="mxinfo " id="T10:U144"><span class="var type1" id="S26T10U209">index_1</span> - <span class="mxinfo " id="T7:U146">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">                        <span class="mxinfo " id="T7:U147"><span class="mxinfo " id="T7:U148"><span class="var type1" id="S15T8U214">P</span>(<span class="mxinfo " id="T10:U150"><span class="var type1" id="S27T10U216">beta</span> + <span class="var type1" id="S26T10U217">index_1</span></span>, <span class="var type1" id="S25T4U218">l_index</span>)</span> = <span class="mxinfo " id="T7:U154"><span class="mxinfo " id="T7:U155"><span class="mxinfo " id="T7:U156">sign(<span class="mxinfo " id="T7:U157"><span class="var type1" id="S15T8U224">P</span>(<span class="mxinfo " id="T10:U159"><span class="var type1" id="S27T10U226">beta</span> + <span class="var type1" id="S32T10U227">index_2</span></span>, <span class="var type1" id="S25T4U228">l_index</span>)</span>)</span> *<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">                            <span class="mxinfo " id="T7:U163">sign(<span class="mxinfo " id="T7:U164"><span class="var type1" id="S15T8U232">P</span>(<span class="mxinfo " id="T10:U166"><span class="mxinfo " id="T10:U167"><span class="var type1" id="S27T10U235">beta</span> + <span class="var type1" id="S26T10U236">index_1</span></span> + <span class="var type1" id="S32T10U237">index_2</span></span>, <span class="var type1" id="S25T4U238">l_index</span>)</span>)</span></span> * <span class="mxinfo " id="T7:U172">min(<span class="mxinfo " id="T7:U173">abs(<span class="mxinfo " id="T7:U174"><span class="var type1" id="S15T8U244">P</span>(<span class="mxinfo " id="T10:U176"><span class="var type1" id="S27T10U246">beta</span> + <span class="var type1" id="S32T10U247">index_2</span></span>, <span class="var type1" id="S25T4U248">l_index</span>)</span>)</span>, <span class="mxinfo " id="T7:U180">abs(<span class="mxinfo " id="T7:U181"><span class="var type1" id="S15T8U252">P</span>(<span class="mxinfo " id="T10:U183"><span class="mxinfo " id="T10:U184"><span class="var type1" id="S27T10U255">beta</span> + <span class="var type1" id="S26T10U256">index_1</span></span> + <span class="var type1" id="S32T10U257">index_2</span></span>, <span class="var type1" id="S25T4U258">l_index</span>)</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">            <span class="keyword">case</span> <span class="mxinfo " id="T7:U189"><span class="var type1" id="S11T7U261">N</span>/2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">                <span class="mxinfo " id="T10:U191"><span class="var type1" id="S26T10U265">index_1</span> = <span class="mxinfo " id="T10:U193"><span class="var type1" id="S8T6U267">lambda_offset</span>(<span class="var type1" id="S13T7U268">m</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S27T10U271">beta</span> = <span class="mxinfo " id="T10:U197">0</span> : <span class="mxinfo " id="T10:U198"><span class="var type1" id="S26T10U275">index_1</span> - <span class="mxinfo " id="T7:U200">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">                    <span class="mxinfo " id="T7:U201"><span class="var type1" id="S33T7U279">x_tmp</span> = <span class="mxinfo " id="T7:U203"><span class="var type1" id="S17T8U281">C</span>(<span class="mxinfo " id="T10:U205"><span class="var type1" id="S27T10U283">beta</span> + <span class="var type1" id="S26T10U284">index_1</span></span>, <span class="mxinfo " id="T4:U208"><span class="mxinfo " id="T4:U209">2 * <span class="var type1" id="S25T4U288">l_index</span></span> - <span class="mxinfo " id="T7:U211">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">                    <span class="mxinfo " id="T7:U212"><span class="mxinfo " id="T7:U213"><span class="var type1" id="S15T8U293">P</span>(<span class="mxinfo " id="T10:U215"><span class="var type1" id="S27T10U295">beta</span> + <span class="var type1" id="S26T10U296">index_1</span></span>, <span class="var type1" id="S25T4U297">l_index</span>)</span> = <span class="mxinfo " id="T7:U219"><span class="mxinfo " id="T7:U220">(<span class="mxinfo " id="T7:U221"><span class="mxinfo " id="T7:U222">1</span> - <span class="mxinfo " id="T7:U223"><span class="mxinfo " id="T7:U224">2</span> * <span class="var type1" id="S33T7U305">x_tmp</span></span></span>) * <span class="mxinfo " id="T7:U226"><span class="var type1" id="S4T3U307">llr</span>(<span class="mxinfo " id="T10:U228"><span class="var type1" id="S27T10U309">beta</span> + <span class="mxinfo " id="T7:U230">1</span></span>)</span></span> + <span class="mxinfo " id="T7:U231"><span class="var type1" id="S4T3U312">llr</span>(<span class="mxinfo " id="T10:U233"><span class="mxinfo " id="T10:U234"><span class="var type1" id="S27T10U315">beta</span> + <span class="mxinfo " id="T7:U236">1</span></span> + <span class="var type1" id="S26T10U317">index_1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S31T7U320">i_layer</span> = <span class="mxinfo " id="T7:U239"><span class="var type1" id="S13T7U324">m</span> - 2</span> : <span class="mxinfo " id="T7:U241">-1</span> : 0</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">                    <span class="mxinfo " id="T10:U242"><span class="var type1" id="S26T10U331">index_1</span> = <span class="mxinfo " id="T10:U244"><span class="var type1" id="S8T6U333">lambda_offset</span>(<span class="mxinfo " id="T7:U246"><span class="var type1" id="S31T7U335">i_layer</span> + <span class="mxinfo " id="T7:U248">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">                    <span class="mxinfo " id="T10:U249"><span class="var type1" id="S32T10U339">index_2</span> = <span class="mxinfo " id="T10:U251"><span class="var type1" id="S8T6U341">lambda_offset</span>(<span class="mxinfo " id="T7:U253"><span class="var type1" id="S31T7U343">i_layer</span> + <span class="mxinfo " id="T7:U255">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">                    <span class="keyword">for</span> <span class="var type1" id="S27T10U347">beta</span> = <span class="mxinfo " id="T10:U257">0</span> : <span class="mxinfo " id="T10:U258"><span class="var type1" id="S26T10U351">index_1</span> - <span class="mxinfo " id="T7:U260">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">                        <span class="mxinfo " id="T7:U261"><span class="mxinfo " id="T7:U262"><span class="var type1" id="S15T8U356">P</span>(<span class="mxinfo " id="T10:U264"><span class="var type1" id="S27T10U358">beta</span> + <span class="var type1" id="S26T10U359">index_1</span></span>, <span class="var type1" id="S25T4U360">l_index</span>)</span> = <span class="mxinfo " id="T7:U268"><span class="mxinfo " id="T7:U269"><span class="mxinfo " id="T7:U270">sign(<span class="mxinfo " id="T7:U271"><span class="var type1" id="S15T8U366">P</span>(<span class="mxinfo " id="T10:U273"><span class="var type1" id="S27T10U368">beta</span> + <span class="var type1" id="S32T10U369">index_2</span></span>, <span class="var type1" id="S25T4U370">l_index</span>)</span>)</span> *<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">                            <span class="mxinfo " id="T7:U277">sign(<span class="mxinfo " id="T7:U278"><span class="var type1" id="S15T8U374">P</span>(<span class="mxinfo " id="T10:U280"><span class="mxinfo " id="T10:U281"><span class="var type1" id="S27T10U377">beta</span> + <span class="var type1" id="S26T10U378">index_1</span></span> + <span class="var type1" id="S32T10U379">index_2</span></span>, <span class="var type1" id="S25T4U380">l_index</span>)</span>)</span></span> * <span class="mxinfo " id="T7:U286">min(<span class="mxinfo " id="T7:U287">abs(<span class="mxinfo " id="T7:U288"><span class="var type1" id="S15T8U386">P</span>(<span class="mxinfo " id="T10:U290"><span class="var type1" id="S27T10U388">beta</span> + <span class="var type1" id="S32T10U389">index_2</span></span>, <span class="var type1" id="S25T4U390">l_index</span>)</span>)</span>, <span class="mxinfo " id="T7:U294">abs(<span class="mxinfo " id="T7:U295"><span class="var type1" id="S15T8U394">P</span>(<span class="mxinfo " id="T10:U297"><span class="mxinfo " id="T10:U298"><span class="var type1" id="S27T10U397">beta</span> + <span class="var type1" id="S26T10U398">index_1</span></span> + <span class="var type1" id="S32T10U399">index_2</span></span>, <span class="var type1" id="S25T4U400">l_index</span>)</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">            <span class="keyword">otherwise</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">                <span class="mxinfo " id="T10:U303"><span class="var type1" id="S26T10U404">index_1</span> = <span class="mxinfo " id="T10:U305"><span class="var type1" id="S8T6U406">lambda_offset</span>(<span class="mxinfo " id="T10:U307"><span class="var type1" id="S22T10U408">layer</span> + <span class="mxinfo " id="T7:U309">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">                <span class="mxinfo " id="T10:U310"><span class="var type1" id="S32T10U412">index_2</span> = <span class="mxinfo " id="T10:U312"><span class="var type1" id="S8T6U414">lambda_offset</span>(<span class="mxinfo " id="T10:U314"><span class="var type1" id="S22T10U416">layer</span> + <span class="mxinfo " id="T7:U316">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S27T10U420">beta</span> = <span class="mxinfo " id="T10:U318">0</span> : <span class="mxinfo " id="T10:U319"><span class="var type1" id="S26T10U424">index_1</span> - <span class="mxinfo " id="T7:U321">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">                    <span class="mxinfo " id="T7:U322"><span class="mxinfo " id="T7:U323"><span class="var type1" id="S15T8U429">P</span>(<span class="mxinfo " id="T10:U325"><span class="var type1" id="S27T10U431">beta</span> + <span class="var type1" id="S26T10U432">index_1</span></span>, <span class="var type1" id="S25T4U433">l_index</span>)</span> = <span class="mxinfo " id="T7:U329"><span class="mxinfo " id="T7:U330">(<span class="mxinfo " id="T7:U331"><span class="mxinfo " id="T7:U332">1</span> - <span class="mxinfo " id="T7:U333"><span class="mxinfo " id="T7:U334">2</span> * <span class="mxinfo " id="T7:U335"><span class="var type1" id="S17T8U442">C</span>(<span class="mxinfo " id="T10:U337"><span class="var type1" id="S27T10U444">beta</span> + <span class="var type1" id="S26T10U445">index_1</span></span>, <span class="mxinfo " id="T4:U340"><span class="mxinfo " id="T4:U341">2 * <span class="var type1" id="S25T4U449">l_index</span></span> - <span class="mxinfo " id="T7:U343">1</span></span>)</span></span></span>) * <span class="mxinfo " id="T7:U344"><span class="var type1" id="S15T8U452">P</span>(<span class="mxinfo " id="T10:U346"><span class="var type1" id="S27T10U454">beta</span> + <span class="var type1" id="S32T10U455">index_2</span></span>, <span class="var type1" id="S25T4U456">l_index</span>)</span></span> +<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">                        <span class="mxinfo " id="T7:U350"><span class="var type1" id="S15T8U458">P</span>(<span class="mxinfo " id="T10:U352"><span class="mxinfo " id="T10:U353"><span class="var type1" id="S27T10U461">beta</span> + <span class="var type1" id="S26T10U462">index_1</span></span> + <span class="var type1" id="S32T10U463">index_2</span></span>, <span class="var type1" id="S25T4U464">l_index</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S31T10U467">i_layer</span> = <span class="mxinfo " id="T10:U359"><span class="var type1" id="S22T10U471">layer</span> - <span class="mxinfo " id="T7:U361">1</span></span> : <span class="mxinfo " id="T10:U362">-1</span> : 0</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">                    <span class="mxinfo " id="T10:U363"><span class="var type1" id="S26T10U478">index_1</span> = <span class="mxinfo " id="T10:U365"><span class="var type1" id="S8T6U480">lambda_offset</span>(<span class="mxinfo " id="T10:U367"><span class="var type1" id="S31T10U482">i_layer</span> + <span class="mxinfo " id="T7:U369">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">                    <span class="mxinfo " id="T10:U370"><span class="var type1" id="S32T10U486">index_2</span> = <span class="mxinfo " id="T10:U372"><span class="var type1" id="S8T6U488">lambda_offset</span>(<span class="mxinfo " id="T10:U374"><span class="var type1" id="S31T10U490">i_layer</span> + <span class="mxinfo " id="T7:U376">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">                    <span class="keyword">for</span> <span class="var type1" id="S27T10U494">beta</span> = <span class="mxinfo " id="T10:U378">0</span> : <span class="mxinfo " id="T10:U379"><span class="var type1" id="S26T10U498">index_1</span> - <span class="mxinfo " id="T7:U381">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">                        <span class="mxinfo " id="T7:U382"><span class="mxinfo " id="T7:U383"><span class="var type1" id="S15T8U503">P</span>(<span class="mxinfo " id="T10:U385"><span class="var type1" id="S27T10U505">beta</span> + <span class="var type1" id="S26T10U506">index_1</span></span>, <span class="var type1" id="S25T4U507">l_index</span>)</span> = <span class="mxinfo " id="T7:U389"><span class="mxinfo " id="T7:U390"><span class="mxinfo " id="T7:U391">sign(<span class="mxinfo " id="T7:U392"><span class="var type1" id="S15T8U513">P</span>(<span class="mxinfo " id="T10:U394"><span class="var type1" id="S27T10U515">beta</span> + <span class="var type1" id="S32T10U516">index_2</span></span>, <span class="var type1" id="S25T4U517">l_index</span>)</span>)</span> *<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">                            <span class="mxinfo " id="T7:U398">sign(<span class="mxinfo " id="T7:U399"><span class="var type1" id="S15T8U521">P</span>(<span class="mxinfo " id="T10:U401"><span class="mxinfo " id="T10:U402"><span class="var type1" id="S27T10U524">beta</span> + <span class="var type1" id="S26T10U525">index_1</span></span> + <span class="var type1" id="S32T10U526">index_2</span></span>, <span class="var type1" id="S25T4U527">l_index</span>)</span>)</span></span> * <span class="mxinfo " id="T7:U407">min(<span class="mxinfo " id="T7:U408">abs(<span class="mxinfo " id="T7:U409"><span class="var type1" id="S15T8U533">P</span>(<span class="mxinfo " id="T10:U411"><span class="var type1" id="S27T10U535">beta</span> + <span class="var type1" id="S32T10U536">index_2</span></span>, <span class="var type1" id="S25T4U537">l_index</span>)</span>)</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">                            <span class="mxinfo " id="T7:U415">abs(<span class="mxinfo " id="T7:U416"><span class="var type1" id="S15T8U541">P</span>(<span class="mxinfo " id="T10:U418"><span class="mxinfo " id="T10:U419"><span class="var type1" id="S27T10U544">beta</span> + <span class="var type1" id="S26T10U545">index_1</span></span> + <span class="var type1" id="S32T10U546">index_2</span></span>, <span class="var type1" id="S25T4U547">l_index</span>)</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">                    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T11:U424"><span class="mxinfo " id="T10:U425"><span class="var type1" id="S7T5U552">frozen_bits</span>(<span class="mxinfo " id="T7:U427"><span class="var type1" id="S21T7U554">phi</span> + <span class="mxinfo " id="T7:U429">1</span></span>)</span> == <span class="mxinfo " id="T7:U430">0</span></span><span class="comment">%if now we decode an unfrozen bit</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">        <span class="mxinfo " id="T12:U431"><span class="var type1" id="S34T12U559">PM_pair</span> = <span class="mxinfo " id="T12:U433"><span class="mxinfo " id="T7:U434">realmax</span> * <span class="mxinfo " id="T12:U435">ones(<span class="mxinfo " id="T7:U436">2</span>, <span class="var type1" id="S5T4U566">L</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S25T4U569">l_index</span> = <span class="mxinfo " id="T4:U439">1</span> : <span class="var type1" id="S5T4U572">L</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T11:U441"><span class="mxinfo " id="T7:U442"><span class="var type1" id="S19T9U577">activepath</span>(<span class="var type1" id="S25T4U578">l_index</span>)</span> == <span class="mxinfo " id="T7:U445">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">                <span class="keyword">continue</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T11:U446"><span class="mxinfo " id="T7:U447"><span class="var type1" id="S15T8U585">P</span>(<span class="mxinfo " id="T13:U449">1</span>, <span class="var type1" id="S25T4U587">l_index</span>)</span> &gt;= <span class="mxinfo " id="T7:U451">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">                <span class="mxinfo " id="T7:U452"><span class="mxinfo " id="T7:U453"><span class="var type1" id="S34T12U592">PM_pair</span>(<span class="mxinfo " id="T7:U455">1</span>, <span class="var type1" id="S25T4U594">l_index</span>)</span> = <span class="mxinfo " id="T7:U457"><span class="var type1" id="S18T9U596">PM</span>(<span class="var type1" id="S25T4U597">l_index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">                <span class="mxinfo " id="T7:U460"><span class="mxinfo " id="T7:U461"><span class="var type1" id="S34T12U601">PM_pair</span>(<span class="mxinfo " id="T7:U463">2</span>, <span class="var type1" id="S25T4U603">l_index</span>)</span> = <span class="mxinfo " id="T7:U465"><span class="mxinfo " id="T7:U466"><span class="var type1" id="S18T9U606">PM</span>(<span class="var type1" id="S25T4U607">l_index</span>)</span> + <span class="mxinfo " id="T7:U469"><span class="var type1" id="S15T8U609">P</span>(<span class="mxinfo " id="T7:U471">1</span>, <span class="var type1" id="S25T4U611">l_index</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">                <span class="mxinfo " id="T7:U473"><span class="mxinfo " id="T7:U474"><span class="var type1" id="S34T12U616">PM_pair</span>(<span class="mxinfo " id="T7:U476">1</span>, <span class="var type1" id="S25T4U618">l_index</span>)</span> = <span class="mxinfo " id="T7:U478"><span class="mxinfo " id="T7:U479"><span class="var type1" id="S18T9U621">PM</span>(<span class="var type1" id="S25T4U622">l_index</span>)</span> - <span class="mxinfo " id="T7:U482"><span class="var type1" id="S15T8U624">P</span>(<span class="mxinfo " id="T7:U484">1</span>, <span class="var type1" id="S25T4U626">l_index</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">                <span class="mxinfo " id="T7:U486"><span class="mxinfo " id="T7:U487"><span class="var type1" id="S34T12U630">PM_pair</span>(<span class="mxinfo " id="T7:U489">2</span>, <span class="var type1" id="S25T4U632">l_index</span>)</span> = <span class="mxinfo " id="T7:U491"><span class="var type1" id="S18T9U634">PM</span>(<span class="var type1" id="S25T4U635">l_index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">        <span class="mxinfo " id="T4:U494"><span class="var type1" id="S37T4U638">middle</span> = <span class="mxinfo " id="T4:U496">min(<span class="mxinfo " id="T7:U497"><span class="mxinfo " id="T7:U498">2</span> * <span class="mxinfo " id="T7:U499">sum(<span class="var type1" id="S19T9U645">activepath</span>)</span></span>, <span class="var type1" id="S5T4U646">L</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">        <span class="mxinfo " id="T14:U502"><span class="var type1" id="S39T14U649">PM_sort</span> = <span class="mxinfo " id="T14:U504">sort(<span class="mxinfo " id="T14:U505"><span class="var type1" id="S34T12U653">PM_pair</span>(:)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">        <span class="mxinfo " id="T7:U507"><span class="var type1" id="S41T7U657">PM_cv</span> = <span class="mxinfo " id="T7:U509"><span class="var type1" id="S39T14U659">PM_sort</span>(<span class="var type1" id="S37T4U660">middle</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">        <span class="mxinfo " id="T15:U512"><span class="var type1" id="S42T15U663">compare</span> = <span class="mxinfo " id="T15:U514"><span class="var type1" id="S34T12U665">PM_pair</span> &lt;= <span class="var type1" id="S41T7U666">PM_cv</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">        <span class="mxinfo " id="T9:U517"><span class="var type1" id="S43T9U669">kill_index</span> = <span class="mxinfo " id="T9:U519">zeros(<span class="var type1" id="S5T4U672">L</span>, 1)</span></span>;<span class="comment">%to record the index of the path that is killed</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">        <span class="mxinfo " id="T7:U521"><span class="var type1" id="S44T7U676">kill_cnt</span> = <span class="mxinfo " id="T7:U523">0</span></span>;<span class="comment">%the total number of killed path</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">        <span class="comment">%the above two variables consist of a stack</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S45T4U680">i</span> = <span class="mxinfo " id="T4:U525">1</span> : <span class="var type1" id="S5T4U683">L</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T11:U527"><span class="mxinfo " id="T11:U528"><span class="var type1" id="S42T15U690">compare</span>(<span class="mxinfo " id="T7:U530">1</span>, <span class="var type1" id="S45T4U692">i</span>)</span> == <span class="mxinfo " id="T7:U532">0</span></span>)&amp;&amp;(<span class="mxinfo " id="T11:U533"><span class="mxinfo " id="T11:U534"><span class="var type1" id="S42T15U697">compare</span>(<span class="mxinfo " id="T7:U536">2</span>, <span class="var type1" id="S45T4U699">i</span>)</span> == <span class="mxinfo " id="T7:U538">0</span></span>)<span class="comment">%which indicates that this path should be killed</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">                <span class="mxinfo " id="T7:U539"><span class="mxinfo " id="T7:U540"><span class="var type1" id="S19T9U704">activepath</span>(<span class="var type1" id="S45T4U705">i</span>)</span> = <span class="mxinfo " id="T7:U543">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">                <span class="mxinfo " id="T7:U544"><span class="var type1" id="S44T7U709">kill_cnt</span> = <span class="mxinfo " id="T7:U546"><span class="var type1" id="S44T7U711">kill_cnt</span> + <span class="mxinfo " id="T7:U548">1</span></span></span>;<span class="comment">%push stack</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">                <span class="mxinfo " id="T7:U549"><span class="mxinfo " id="T7:U550"><span class="var type1" id="S43T9U716">kill_index</span>(<span class="var type1" id="S44T7U717">kill_cnt</span>)</span> = <span class="var type1" id="S45T4U718">i</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S25T4U721">l_index</span> = <span class="mxinfo " id="T4:U555">1</span> : <span class="var type1" id="S5T4U724">L</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T11:U557"><span class="mxinfo " id="T7:U558"><span class="var type1" id="S19T9U729">activepath</span>(<span class="var type1" id="S25T4U730">l_index</span>)</span> == <span class="mxinfo " id="T7:U561">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">                <span class="keyword">continue</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">            <span class="mxinfo " id="T7:U562"><span class="var type1" id="S46T7U735">path_state</span> = <span class="mxinfo " id="T7:U564"><span class="mxinfo " id="T7:U565"><span class="mxinfo " id="T11:U566"><span class="var type1" id="S42T15U739">compare</span>(<span class="mxinfo " id="T13:U568">1</span>, <span class="var type1" id="S25T4U741">l_index</span>)</span> * 2</span> + <span class="mxinfo " id="T11:U570"><span class="var type1" id="S42T15U744">compare</span>(<span class="mxinfo " id="T7:U572">2</span>, <span class="var type1" id="S25T4U746">l_index</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">            <span class="keyword">switch</span> <span class="var type1" id="S46T7U748">path_state</span><span class="comment">%path_state can equal to 0, but in this case we do no operation.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">                <span class="keyword">case</span> <span class="mxinfo " id="T7:U575">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">                    <span class="mxinfo " id="T7:U576"><span class="mxinfo " id="T7:U577"><span class="var type1" id="S3T2U754">u</span>(<span class="var type1" id="S20T7U755">cnt_u</span>, <span class="var type1" id="S25T4U756">l_index</span>)</span> = <span class="mxinfo " id="T7:U581">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">                    <span class="mxinfo " id="T7:U582"><span class="mxinfo " id="T7:U583"><span class="var type1" id="S17T8U761">C</span>(<span class="mxinfo " id="T7:U585">1</span>, <span class="mxinfo " id="T7:U586"><span class="mxinfo " id="T4:U587"><span class="mxinfo " id="T4:U588">2 * <span class="var type1" id="S25T4U767">l_index</span></span> - <span class="mxinfo " id="T7:U590">1</span></span> + <span class="var type1" id="S23T7U769">phi_mod_2</span></span>)</span> = <span class="mxinfo " id="T7:U592">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">                    <span class="mxinfo " id="T7:U593"><span class="mxinfo " id="T7:U594"><span class="var type1" id="S18T9U774">PM</span>(<span class="var type1" id="S25T4U775">l_index</span>)</span> = <span class="mxinfo " id="T7:U597"><span class="var type1" id="S34T12U777">PM_pair</span>(<span class="mxinfo " id="T7:U599">2</span>, <span class="var type1" id="S25T4U779">l_index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">                <span class="keyword">case</span> <span class="mxinfo " id="T7:U601">2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">                    <span class="mxinfo " id="T7:U602"><span class="mxinfo " id="T7:U603"><span class="var type1" id="S3T2U785">u</span>(<span class="var type1" id="S20T7U786">cnt_u</span>, <span class="var type1" id="S25T4U787">l_index</span>)</span> = <span class="mxinfo " id="T7:U607">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">                    <span class="mxinfo " id="T7:U608"><span class="mxinfo " id="T7:U609"><span class="var type1" id="S17T8U792">C</span>(<span class="mxinfo " id="T7:U611">1</span>, <span class="mxinfo " id="T7:U612"><span class="mxinfo " id="T4:U613"><span class="mxinfo " id="T4:U614">2 * <span class="var type1" id="S25T4U798">l_index</span></span> - <span class="mxinfo " id="T7:U616">1</span></span> + <span class="var type1" id="S23T7U800">phi_mod_2</span></span>)</span> = <span class="mxinfo " id="T7:U618">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">                    <span class="mxinfo " id="T7:U619"><span class="mxinfo " id="T7:U620"><span class="var type1" id="S18T9U805">PM</span>(<span class="var type1" id="S25T4U806">l_index</span>)</span> = <span class="mxinfo " id="T7:U623"><span class="var type1" id="S34T12U808">PM_pair</span>(<span class="mxinfo " id="T7:U625">1</span>, <span class="var type1" id="S25T4U810">l_index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">                <span class="keyword">case</span> <span class="mxinfo " id="T7:U627">3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">                    <span class="mxinfo " id="T7:U628"><span class="var type1" id="S47T7U815">index</span> = <span class="mxinfo " id="T7:U630"><span class="var type1" id="S43T9U817">kill_index</span>(<span class="var type1" id="S44T7U818">kill_cnt</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">                    <span class="mxinfo " id="T7:U633"><span class="var type1" id="S44T7U821">kill_cnt</span> = <span class="mxinfo " id="T7:U635"><span class="var type1" id="S44T7U823">kill_cnt</span> - <span class="mxinfo " id="T7:U637">1</span></span></span>;<span class="comment">%pop stack</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">                    <span class="mxinfo " id="T7:U638"><span class="mxinfo " id="T7:U639"><span class="var type1" id="S19T9U828">activepath</span>(<span class="var type1" id="S47T7U829">index</span>)</span> = <span class="mxinfo " id="T7:U642">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">                    <span class="mxinfo " id="T16:U643"><span class="mxinfo " id="T16:U644"><span class="var type1" id="S15T8U834">P</span>(<span class="mxinfo " id="T17:U646">:</span>, <span class="var type1" id="S47T7U836">index</span>)</span> = <span class="mxinfo " id="T16:U648"><span class="var type1" id="S15T8U838">P</span>(<span class="mxinfo " id="T17:U650">:</span>, <span class="var type1" id="S25T4U840">l_index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">                    <span class="mxinfo " id="T16:U652"><span class="mxinfo " id="T16:U653"><span class="var type1" id="S17T8U844">C</span>(<span class="mxinfo " id="T17:U655">:</span>, <span class="mxinfo " id="T7:U656"><span class="mxinfo " id="T7:U657"><span class="mxinfo " id="T7:U658">2</span>*<span class="var type1" id="S47T7U849">index</span></span>-<span class="mxinfo " id="T7:U660">1</span></span>)</span> = <span class="mxinfo " id="T16:U661"><span class="var type1" id="S17T8U852">C</span>(<span class="mxinfo " id="T17:U663">:</span>, <span class="mxinfo " id="T4:U664"><span class="mxinfo " id="T4:U665">2*<span class="var type1" id="S25T4U857">l_index</span></span>-<span class="mxinfo " id="T7:U667">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">                    <span class="mxinfo " id="T16:U668"><span class="mxinfo " id="T16:U669"><span class="var type1" id="S17T8U862">C</span>(<span class="mxinfo " id="T17:U671">:</span>, <span class="mxinfo " id="T7:U672"><span class="mxinfo " id="T7:U673">2</span>*<span class="var type1" id="S47T7U866">index</span></span>)</span> = <span class="mxinfo " id="T16:U675"><span class="var type1" id="S17T8U868">C</span>(<span class="mxinfo " id="T17:U677">:</span>, <span class="mxinfo " id="T4:U678">2*<span class="var type1" id="S25T4U872">l_index</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">                    <span class="mxinfo " id="T9:U680"><span class="mxinfo " id="T9:U681"><span class="var type1" id="S3T2U876">u</span>(<span class="mxinfo " id="T18:U683">:</span>, <span class="var type1" id="S47T7U878">index</span>)</span> = <span class="mxinfo " id="T9:U685"><span class="var type1" id="S3T2U880">u</span>(<span class="mxinfo " id="T18:U687">:</span>, <span class="var type1" id="S25T4U882">l_index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">                    <span class="mxinfo " id="T7:U689"><span class="mxinfo " id="T7:U690"><span class="var type1" id="S3T2U886">u</span>(<span class="var type1" id="S20T7U887">cnt_u</span>, <span class="var type1" id="S25T4U888">l_index</span>)</span> = <span class="mxinfo " id="T7:U694">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">                    <span class="mxinfo " id="T7:U695"><span class="mxinfo " id="T7:U696"><span class="var type1" id="S3T2U893">u</span>(<span class="var type1" id="S20T7U894">cnt_u</span>, <span class="var type1" id="S47T7U895">index</span>)</span> = <span class="mxinfo " id="T7:U700">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">                    <span class="mxinfo " id="T7:U701"><span class="mxinfo " id="T7:U702"><span class="var type1" id="S17T8U900">C</span>(<span class="mxinfo " id="T7:U704">1</span>, <span class="mxinfo " id="T7:U705"><span class="mxinfo " id="T4:U706"><span class="mxinfo " id="T4:U707">2 * <span class="var type1" id="S25T4U906">l_index</span></span> - <span class="mxinfo " id="T7:U709">1</span></span> + <span class="var type1" id="S23T7U908">phi_mod_2</span></span>)</span> = <span class="mxinfo " id="T7:U711">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">                    <span class="mxinfo " id="T7:U712"><span class="mxinfo " id="T7:U713"><span class="var type1" id="S17T8U913">C</span>(<span class="mxinfo " id="T7:U715">1</span>, <span class="mxinfo " id="T7:U716"><span class="mxinfo " id="T7:U717"><span class="mxinfo " id="T7:U718"><span class="mxinfo " id="T7:U719">2</span> * <span class="var type1" id="S47T7U919">index</span></span> - <span class="mxinfo " id="T7:U721">1</span></span> + <span class="var type1" id="S23T7U921">phi_mod_2</span></span>)</span> = <span class="mxinfo " id="T7:U723">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">                    <span class="mxinfo " id="T7:U724"><span class="mxinfo " id="T7:U725"><span class="var type1" id="S18T9U926">PM</span>(<span class="var type1" id="S25T4U927">l_index</span>)</span> = <span class="mxinfo " id="T7:U728"><span class="var type1" id="S34T12U929">PM_pair</span>(<span class="mxinfo " id="T7:U730">1</span>, <span class="var type1" id="S25T4U931">l_index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">                    <span class="mxinfo " id="T7:U732"><span class="mxinfo " id="T7:U733"><span class="var type1" id="S18T9U935">PM</span>(<span class="var type1" id="S47T7U936">index</span>)</span> = <span class="mxinfo " id="T7:U736"><span class="var type1" id="S34T12U938">PM_pair</span>(<span class="mxinfo " id="T7:U738">2</span>, <span class="var type1" id="S25T4U940">l_index</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">        <span class="mxinfo " id="T7:U740"><span class="var type1" id="S20T7U943">cnt_u</span> = <span class="mxinfo " id="T7:U742"><span class="var type1" id="S20T7U945">cnt_u</span> + <span class="mxinfo " id="T7:U744">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="keyword">else</span><span class="comment">%frozen bit operation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S25T4U950">l_index</span> = <span class="mxinfo " id="T4:U746">1</span> : <span class="var type1" id="S5T4U953">L</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T11:U748"><span class="mxinfo " id="T7:U749"><span class="var type1" id="S19T9U958">activepath</span>(<span class="var type1" id="S25T4U959">l_index</span>)</span> == <span class="mxinfo " id="T7:U752">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">                <span class="keyword">continue</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T11:U753"><span class="mxinfo " id="T7:U754"><span class="var type1" id="S15T8U966">P</span>(<span class="mxinfo " id="T13:U756">1</span>, <span class="var type1" id="S25T4U968">l_index</span>)</span> &lt; <span class="mxinfo " id="T7:U758">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">                <span class="mxinfo " id="T7:U759"><span class="mxinfo " id="T7:U760"><span class="var type1" id="S18T9U973">PM</span>(<span class="var type1" id="S25T4U974">l_index</span>)</span> = <span class="mxinfo " id="T7:U763"><span class="mxinfo " id="T7:U764"><span class="var type1" id="S18T9U977">PM</span>(<span class="var type1" id="S25T4U978">l_index</span>)</span> - <span class="mxinfo " id="T7:U767"><span class="var type1" id="S15T8U980">P</span>(<span class="mxinfo " id="T7:U769">1</span>, <span class="var type1" id="S25T4U982">l_index</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T11:U771"><span class="var type1" id="S23T7U986">phi_mod_2</span> == <span class="mxinfo " id="T7:U773">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">                <span class="mxinfo " id="T7:U774"><span class="mxinfo " id="T7:U775"><span class="var type1" id="S17T8U991">C</span>(<span class="mxinfo " id="T7:U777">1</span>, <span class="mxinfo " id="T4:U778"><span class="mxinfo " id="T4:U779">2 * <span class="var type1" id="S25T4U996">l_index</span></span> - <span class="mxinfo " id="T7:U781">1</span></span>)</span> = <span class="mxinfo " id="T7:U782">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">                <span class="mxinfo " id="T7:U783"><span class="mxinfo " id="T7:U784"><span class="var type1" id="S17T8U1003">C</span>(<span class="mxinfo " id="T7:U786">1</span>, <span class="mxinfo " id="T4:U787">2 * <span class="var type1" id="S25T4U1007">l_index</span></span>)</span> = <span class="mxinfo " id="T7:U789">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">            <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S25T4U1011">l_index</span> = <span class="mxinfo " id="T4:U791">1</span> : <span class="var type1" id="S5T4U1014">L</span><span class="comment">%partial-sum return</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T11:U793"><span class="mxinfo " id="T7:U794"><span class="var type1" id="S19T9U1019">activepath</span>(<span class="var type1" id="S25T4U1020">l_index</span>)</span> == <span class="mxinfo " id="T7:U797">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">            <span class="keyword">continue</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo " id="T11:U798"><span class="var type1" id="S23T7U1028">phi_mod_2</span>  == <span class="mxinfo " id="T7:U800">1</span></span>) &amp;&amp; (<span class="mxinfo " id="T11:U801"><span class="var type1" id="S21T7U1032">phi</span> ~= <span class="mxinfo " id="T7:U803"><span class="var type1" id="S11T7U1034">N</span> - <span class="mxinfo " id="T7:U805">1</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">            <span class="mxinfo " id="T10:U806"><span class="var type1" id="S22T10U1038">layer</span> = <span class="mxinfo " id="T10:U808"><span class="var type1" id="S10T5U1040">bit_layer_vec</span>(<span class="mxinfo " id="T7:U810"><span class="var type1" id="S21T7U1042">phi</span> + <span class="mxinfo " id="T7:U812">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S31T10U1046">i_layer</span> = <span class="mxinfo " id="T10:U814">0</span> : <span class="mxinfo " id="T10:U815"><span class="var type1" id="S22T10U1050">layer</span> - <span class="mxinfo " id="T7:U817">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">                <span class="mxinfo " id="T10:U818"><span class="var type1" id="S26T10U1054">index_1</span> = <span class="mxinfo " id="T10:U820"><span class="var type1" id="S8T6U1056">lambda_offset</span>(<span class="mxinfo " id="T10:U822"><span class="var type1" id="S31T10U1058">i_layer</span> + <span class="mxinfo " id="T7:U824">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">                <span class="mxinfo " id="T10:U825"><span class="var type1" id="S32T10U1062">index_2</span> = <span class="mxinfo " id="T10:U827"><span class="var type1" id="S8T6U1064">lambda_offset</span>(<span class="mxinfo " id="T10:U829"><span class="var type1" id="S31T10U1066">i_layer</span> + <span class="mxinfo " id="T7:U831">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">                <span class="keyword">for</span> <span class="var type1" id="S27T10U1070">beta</span> = <span class="var type1" id="S26T10U1072">index_1</span> : <span class="mxinfo " id="T10:U834"><span class="mxinfo " id="T10:U835">2 * <span class="var type1" id="S26T10U1076">index_1</span></span> - <span class="mxinfo " id="T7:U837">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">                    <span class="mxinfo " id="T7:U838"><span class="mxinfo " id="T7:U839"><span class="var type1" id="S17T8U1081">C</span>(<span class="mxinfo " id="T10:U841"><span class="var type1" id="S27T10U1083">beta</span> + <span class="var type1" id="S26T10U1084">index_1</span></span>, <span class="mxinfo " id="T4:U844">2 * <span class="var type1" id="S25T4U1087">l_index</span></span>)</span> = <span class="mxinfo " id="T7:U846">mod(<span class="mxinfo " id="T7:U847"><span class="mxinfo " id="T7:U848"><span class="var type1" id="S17T8U1092">C</span>(<span class="var type1" id="S27T10U1093">beta</span>, <span class="mxinfo " id="T4:U851"><span class="mxinfo " id="T4:U852">2 * <span class="var type1" id="S25T4U1097">l_index</span></span>-<span class="mxinfo " id="T7:U854">1</span></span>)</span> + <span class="mxinfo " id="T7:U855"><span class="var type1" id="S17T8U1100">C</span>(<span class="var type1" id="S27T10U1101">beta</span>, <span class="mxinfo " id="T4:U858">2 * <span class="var type1" id="S25T4U1104">l_index</span></span>)</span></span>, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">                    <span class="mxinfo " id="T7:U860"><span class="mxinfo " id="T7:U861"><span class="var type1" id="S17T8U1109">C</span>(<span class="mxinfo " id="T10:U863"><span class="var type1" id="S27T10U1111">beta</span> + <span class="var type1" id="S32T10U1112">index_2</span></span>, <span class="mxinfo " id="T4:U866">2 * <span class="var type1" id="S25T4U1115">l_index</span></span>)</span> = <span class="mxinfo " id="T7:U868"><span class="var type1" id="S17T8U1117">C</span>(<span class="var type1" id="S27T10U1118">beta</span>, <span class="mxinfo " id="T4:U871">2 * <span class="var type1" id="S25T4U1121">l_index</span></span>)</span></span>;   </span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">            <span class="mxinfo " id="T10:U873"><span class="var type1" id="S26T10U1124">index_1</span> = <span class="mxinfo " id="T10:U875"><span class="var type1" id="S8T6U1126">lambda_offset</span>(<span class="mxinfo " id="T10:U877"><span class="var type1" id="S22T10U1128">layer</span> + <span class="mxinfo " id="T7:U879">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">            <span class="mxinfo " id="T10:U880"><span class="var type1" id="S32T10U1132">index_2</span> = <span class="mxinfo " id="T10:U882"><span class="var type1" id="S8T6U1134">lambda_offset</span>(<span class="mxinfo " id="T10:U884"><span class="var type1" id="S22T10U1136">layer</span> + <span class="mxinfo " id="T7:U886">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S27T10U1140">beta</span> = <span class="var type1" id="S26T10U1142">index_1</span> : <span class="mxinfo " id="T10:U889"><span class="mxinfo " id="T10:U890">2 * <span class="var type1" id="S26T10U1146">index_1</span></span> - <span class="mxinfo " id="T7:U892">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">                <span class="mxinfo " id="T7:U893"><span class="mxinfo " id="T7:U894"><span class="var type1" id="S17T8U1151">C</span>(<span class="mxinfo " id="T10:U896"><span class="var type1" id="S27T10U1153">beta</span> + <span class="var type1" id="S26T10U1154">index_1</span></span>, <span class="mxinfo " id="T4:U899"><span class="mxinfo " id="T4:U900">2 * <span class="var type1" id="S25T4U1158">l_index</span></span> - <span class="mxinfo " id="T7:U902">1</span></span>)</span> = <span class="mxinfo " id="T7:U903">mod(<span class="mxinfo " id="T7:U904"><span class="mxinfo " id="T7:U905"><span class="var type1" id="S17T8U1164">C</span>(<span class="var type1" id="S27T10U1165">beta</span>, <span class="mxinfo " id="T4:U908"><span class="mxinfo " id="T4:U909">2 * <span class="var type1" id="S25T4U1169">l_index</span></span>-<span class="mxinfo " id="T7:U911">1</span></span>)</span> + <span class="mxinfo " id="T7:U912"><span class="var type1" id="S17T8U1172">C</span>(<span class="var type1" id="S27T10U1173">beta</span>, <span class="mxinfo " id="T4:U915">2 * <span class="var type1" id="S25T4U1176">l_index</span></span>)</span></span>, 2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">                <span class="mxinfo " id="T7:U917"><span class="mxinfo " id="T7:U918"><span class="var type1" id="S17T8U1181">C</span>(<span class="mxinfo " id="T10:U920"><span class="var type1" id="S27T10U1183">beta</span> + <span class="var type1" id="S32T10U1184">index_2</span></span>, <span class="mxinfo " id="T4:U923"><span class="mxinfo " id="T4:U924">2 * <span class="var type1" id="S25T4U1188">l_index</span></span> - <span class="mxinfo " id="T7:U926">1</span></span>)</span> = <span class="mxinfo " id="T7:U927"><span class="var type1" id="S17T8U1191">C</span>(<span class="var type1" id="S27T10U1192">beta</span>, <span class="mxinfo " id="T4:U930">2 * <span class="var type1" id="S25T4U1195">l_index</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">            <span class="keyword">end</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"><span class="comment">%path selection.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">[<span class="mxinfo " id="T9:U932">~</span>, <span class="var type1" id="S48T9U1200">path_ordered</span>] = sort(<span class="var type1" id="S18T9U1203">PM</span>);<span class="comment">%对PM进行排序</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="mxinfo " id="T1:U935"><span class="var type1" id="S18T1U1206">PM</span>=<span class="mxinfo " id="T1:U937"><span class="var type1" id="S18T9U1208">PM</span>'</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line"><span class="var type1" id="S3T2U1210">u</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line"><span class="mxinfo " id="T7:U940"><span class="var type1" id="S49T7U1213">path_num</span> = <span class="mxinfo " id="T7:U942"><span class="var type1" id="S48T9U1215">path_ordered</span>(<span class="mxinfo " id="T7:U944">1</span>)</span></span><span class="comment">%取排序最小的那个在原来PM数组中占第几列</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line"><span class="mxinfo " id="T1:U945"><span class="var type1" id="S2T1U1219">decoder</span> = <span class="mxinfo " id="T1:U947"><span class="mxinfo " id="T9:U948"><span class="var type1" id="S3T2U1222">u</span>(<span class="mxinfo " id="T18:U950">:</span>, <span class="var type1" id="S49T7U1224">path_num</span>)</span>'</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
